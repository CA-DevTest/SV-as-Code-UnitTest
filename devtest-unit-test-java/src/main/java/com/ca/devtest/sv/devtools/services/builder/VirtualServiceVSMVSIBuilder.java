/**
 * 
 */
package com.ca.devtest.sv.devtools.services.builder;

import java.io.File;
import java.io.IOException;
import java.net.InetAddress;
import java.net.UnknownHostException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;

import com.ca.devtest.sv.devtools.VirtualServiceEnvironment;
import com.ca.devtest.sv.devtools.annotation.VirtualServiceType;
import com.ca.devtest.sv.devtools.utils.PackMarFile;

/**
 * @author gaspa03
 *
 * 
 */
public final class VirtualServiceVSMVSIBuilder extends VirtualServiceBuilder {
	
	private File workingFolder=null;
	private static final String USER="<UserInfo>\n<id>386</id>\n<uniqueId>svpower</uniqueId>\n<miscInfo>miscInfo</miscInfo>\n<roles>\n<role>\n<id>375</id>\n<name>SV Power</name>\n<description>SV POWER</description>\n<activities>\n<activity>\n<id>263</id>\n<name>Stop Test</name>\n<description>Stop a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>266</id>\n<name>View Test</name>\n<description>View a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>317</id>\n<name>Remove metric at runtime</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>307</id>\n<name>Report Administration</name>\n<description></description>\n<childActivities>\n<activity>\n<id>308</id>\n<name>Access reporting console</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>309</id>\n<name>View report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>310</id>\n<name>View other users&apos; report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>311</id>\n<name>View PDF report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>312</id>\n<name>View other&apos;s PDF report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>313</id>\n<name>Export Excel report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>314</id>\n<name>Export other&apos;s Excel report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType></licenseType>\n</activity>\n<activity>\n<id>357</id>\n<name>View Virtual Service Model</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>314</id>\n<name>Export other&apos;s Excel report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>318</id>\n<name>Pause metrics collection</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>277</id>\n<name>VSE Service Deployment</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>361</id>\n<name>Edit Virtual Service Image</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>278</id>\n<name>VSE Service Archive Retrieval</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>320</id>\n<name>Save metric data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>342</id>\n<name>View a Configuration</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>348</id>\n<name>View a Suite</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>368</id>\n<name>View ITR Properties</name>\n<description>View Properties Tab in ITR Panel</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>315</id>\n<name>Metric/Event Administration</name>\n<description></description>\n<childActivities>\n<activity>\n<id>316</id>\n<name>Add metric at runtime</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>317</id>\n<name>Remove metric at runtime</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>318</id>\n<name>Pause metrics collection</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>319</id>\n<name>Save interval data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>320</id>\n<name>Save metric data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>321</id>\n<name>Save event data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType></licenseType>\n</activity>\n<activity>\n<id>306</id>\n<name>Activate/Deactivate monitor on CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>367</id>\n<name>Execute Instant Replay</name>\n<description>Execute Instant Replay</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>301</id>\n<name>CVS Administration</name>\n<description></description>\n<childActivities>\n<activity>\n<id>302</id>\n<name>View CVS Dashboard</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>303</id>\n<name>Deploy or re-deploy monitor to CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>304</id>\n<name>Delete monitor from CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>305</id>\n<name>Run monitor immediately on CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>306</id>\n<name>Activate/Deactivate monitor on CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType></licenseType>\n</activity>\n<activity>\n<id>284</id>\n<name>Update Virtual Service Think Scale</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>310</id>\n<name>View other users&apos; report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>289</id>\n<name>Heal Virtual Service Image</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>260</id>\n<name>Test/Suite Administration</name>\n<description></description>\n<childActivities>\n<activity>\n<id>261</id>\n<name>Stage Test</name>\n<description>Stage a Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n<numericLimits>\n<id>256</id>\n<limitName>Maximum number of tests staged</limitName>\n<limitValue>-1</limitValue>\n</numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>262</id>\n<name>Stage Suite</name>\n<description>Stage a Suite</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n<numericLimits>\n<id>257</id>\n<limitName>Maximum number of suites staged</limitName>\n<limitValue>-1</limitValue>\n</numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>263</id>\n<name>Stop Test</name>\n<description>Stop a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>264</id>\n<name>Kill Test</name>\n<description>Kill a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>265</id>\n<name>Optimize Test</name>\n<description>Use Load Test Optimizer</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>266</id>\n<name>View Test</name>\n<description>View a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>267</id>\n<name>Quick Stage Test</name>\n<description>Quick Stage a Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>268</id>\n<name>Stage Local Suite</name>\n<description>Stage a Local Suite</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType></licenseType>\n</activity>\n<activity>\n<id>313</id>\n<name>Export Excel report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>355</id>\n<name>Edit an Audit Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>362</id>\n<name>Create a New Virtual Service Image</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>350</id>\n<name>Create a New Suite</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>309</id>\n<name>View report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>363</id>\n<name>View Copybook Bundle</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>295</id>\n<name>Monitor Coordinator</name>\n<description>Monitor Coordinator</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>ADMIN_USER</licenseType>\n</activity>\n<activity>\n<id>286</id>\n<name>Update Virtual Service Group Tag</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>262</id>\n<name>Stage Suite</name>\n<description>Stage a Suite</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n<numericLimits>\n<id>257</id>\n<limitName>Maximum number of suites staged</limitName>\n<limitValue>-1</limitValue>\n</numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>283</id>\n<name>Update Virtual Service Capacity</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>265</id>\n<name>Optimize Test</name>\n<description>Use Load Test Optimizer</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>285</id>\n<name>Update Virtual Service Auto-Restart</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>351</id>\n<name>View a Test Case</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>364</id>\n<name>Edit Copybook Bundle</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>281</id>\n<name>Stop VSE Service</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>321</id>\n<name>Save event data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>298</id>\n<name>Monitor Simulator</name>\n<description>Monitor Simulator</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>ADMIN_USER</licenseType>\n</activity>\n<activity>\n<id>282</id>\n<name>Update Deployed VSE Service</name>\n<description></description>\n<childActivities>\n<activity>\n<id>283</id>\n<name>Update Virtual Service Capacity</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>284</id>\n<name>Update Virtual Service Think Scale</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>285</id>\n<name>Update Virtual Service Auto-Restart</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>286</id>\n<name>Update Virtual Service Group Tag</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType></licenseType>\n</activity>\n<activity>\n<id>352</id>\n<name>Edit a Test Case</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>359</id>\n<name>Create a New Virtual Service Model</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>343</id>\n<name>Edit a Configuration</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>275</id>\n<name>Monitor VSE Server</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>ADMIN_USER</licenseType>\n</activity>\n<activity>\n<id>264</id>\n<name>Kill Test</name>\n<description>Kill a Running Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>354</id>\n<name>View an Audit Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>305</id>\n<name>Run monitor immediately on CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>302</id>\n<name>View CVS Dashboard</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>356</id>\n<name>Create a New Audit Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>267</id>\n<name>Quick Stage Test</name>\n<description>Quick Stage a Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>311</id>\n<name>View PDF report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>303</id>\n<name>Deploy or re-deploy monitor to CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>316</id>\n<name>Add metric at runtime</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>349</id>\n<name>Edit a Suite</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>360</id>\n<name>View Virtual Service Image</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>288</id>\n<name>Reset Virtual Service Transaction Counts</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>261</id>\n<name>Stage Test</name>\n<description>Stage a Test</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n<numericLimits>\n<id>256</id>\n<limitName>Maximum number of tests staged</limitName>\n<limitValue>-1</limitValue>\n</numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>319</id>\n<name>Save interval data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>365</id>\n<name>Create a New Copybook Bundle</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>270</id>\n<name>View VSE Dashboard</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>358</id>\n<name>Edit Virtual Service Model</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SV_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>341</id>\n<name>Start LISA Workstation</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>292</id>\n<name>Monitor Registry</name>\n<description>Monitor Registry</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>ADMIN_USER</licenseType>\n</activity>\n<activity>\n<id>312</id>\n<name>View other&apos;s PDF report data</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>344</id>\n<name>Create a New Configuration</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>268</id>\n<name>Stage Local Suite</name>\n<description>Stage a Local Suite</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>369</id>\n<name>View ITR Test Events</name>\n<description>View Test Events Tab in ITR Panel</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>308</id>\n<name>Access reporting console</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>304</id>\n<name>Delete monitor from CVS</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>346</id>\n<name>Edit a Staging Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>345</id>\n<name>View a Staging Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>287</id>\n<name>Set Virtual Service Execution Mode</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>347</id>\n<name>Create a New Staging Document</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>280</id>\n<name>Start VSE Service</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>SVT_RUNTIME_USER</licenseType>\n</activity>\n<activity>\n<id>366</id>\n<name>Execute ITR</name>\n<description>Execute Interactive Test Run (ITR)</description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n<activity>\n<id>353</id>\n<name>Create a New Test Case</name>\n<description></description>\n<childActivities>\n</childActivities>\n<numericLimits>\n</numericLimits>\n<listItems>\n</listItems>\n<customInfo>\n</customInfo>\n<licenseType>TEST_POWER_USER</licenseType>\n</activity>\n</activities>\n</role>\n</roles>\n</UserInfo>\n";

	public VirtualServiceVSMVSIBuilder(String name, VirtualServiceEnvironment vse,File workingFolder) {
		super(name, vse);
		this.workingFolder=workingFolder;
		setType(VirtualServiceType.VSM);
	}

	protected File packVirtualService() throws IOException {

		Map<String, Object> config = new HashMap<String, Object>();
		// add Info to maraudit File
		config.put("dateOfMar", getDateOfMar());
		config.put("hostname", getHostName());
		config.put("serviceName", getServiceName());
		config.put("virtualService", this);
		config.put("user", USER);
		config.putAll(getParameters());
		
		return PackMarFile.packVirtualService(getWorkingFolder(),getServiceName(),config);
	}

	/**
	 * @return
	 */
	private String getHostName() {
		String result = "UNKNOWN";
		try {
			InetAddress address = InetAddress.getLocalHost();

			result = address.getHostName();
		} catch (UnknownHostException e) {

		}
		return result;
	}
	/**
	 * @return
	 */
	private String getDateOfMar() {
		SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd.HH:mm:ss.SSS.Z");
		
		return df.format(new Date());
	}
	/**
	 * @return the workingFolder
	 */
	protected File getWorkingFolder() {
		return workingFolder;
	}

	/**
	 * @param workingFolder the workingFolder to set
	 */
	protected void setWorkingFolder(File workingFolder) {
		this.workingFolder = workingFolder;
	}
}
